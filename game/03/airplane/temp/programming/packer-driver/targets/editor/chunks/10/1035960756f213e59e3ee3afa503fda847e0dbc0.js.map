{"version":3,"sources":["file:///F:/cocos/cocos_game/game/03/airplane/assets/script/framework/GameManager.ts"],"names":["_decorator","Component","Node","Prefab","math","macro","Label","Animation","Bullet","BulletProp","EnemyPlane","SelfPlane","AudioManager","Constant","PoolManager","ccclass","property","GameManager","isGameStart","_curCreateEnemyTime","_combinationInterval","Combination","PLAN1","_bulletType","BulletPropType","BULLET_INIT","_curShootTime","_isShooting","_score","start","_init","playAudioEffect","name","audioEffect","play","isShooting","v","update","deltaTime","selfPlane","isDie","gameOver","shootTime","BULLET_H","createPlayerBulletH","BULLET_S","createPlayerBulletS","BULLET_M","createPlayerBulletM","createPlayerBullet","createEnemyTime","createEnemyPlan1","PLAN2","randomCombination","randomRangeInt","createEnemyPlan2","createEnemyPlan3","PLAN3","returnMain","node","setPosition","gameStart","gameOverPage","active","_changePlaneMode","gameScore","string","toString","init","gameReStart","gamePage","gameOverScore","overAnim","unschedule","_modeChanged","_destroyAll","children","length","i","child","instance","putNode","bulletRoot","whichEnemy","prefab","speed","EnemyType","TYPE1","enemy01","enemy1Speed","enemy02","enemy2Speed","enemy","getNode","enemyComp","getComponent","show","randomPos","enemyArray","Array","element","combinationPos","startIndex","createEnemyEffect","pos","effect","enemyExplode","bullet","bullet05","position","x","y","z","bulletComp","bulletSpeed","bullet1","bullet03","bulletComp1","bullet2","bulletComp2","bullet01","Direction","LEFT","RIGHT","createEnemyBullet","targetPos","bullet02","setParent","createSelpBullet","console","info","createBulletProp","randomProp","bulletPropH","bulletPropS","bulletPropM","prop","propComp","bulletPropSpeed","changeBulletType","type","log","addScore","schedule","REPEAT_FOREVER"],"mappings":"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","sourcesContent":["import { _decorator, Component, instantiate, Node, Prefab, math,Vec3, macro,Label,Animation  } from 'cc';\r\nimport { Bullet } from '../bullet/Bullet';\r\nimport { BulletProp } from '../bullet/BulletProp';\r\nimport { EnemyPlane } from '../plane/EnemyPlane';\r\nimport { SelfPlane } from '../plane/SelfPlane';\r\nimport { AudioManager } from './AudioManager';\r\nimport { Constant } from './Constant';\r\nimport { PoolManager } from './PoolManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('GameManager')\r\nexport class GameManager extends Component {\r\n    // plane\r\n    @property(SelfPlane)\r\n    public selfPlane: SelfPlane = null;\r\n\r\n    // enemy plane\r\n    @property(Prefab)\r\n    public enemy01: Prefab = null;\r\n    @property(Prefab)\r\n    public enemy02: Prefab = null;\r\n\r\n    @property\r\n    public createEnemyTime = 1;\r\n    @property\r\n    public enemy1Speed = 0.5;\r\n    @property\r\n    public enemy2Speed = 0.7;\r\n\r\n    @property(Prefab)\r\n    public enemyExplode: Prefab = null;\r\n\r\n    //bullet\r\n    @property(Prefab)\r\n    public bullet01: Prefab = null;\r\n    @property(Prefab)\r\n    public bullet02: Prefab = null;\r\n    @property(Prefab)\r\n    public bullet03: Prefab = null;\r\n    @property(Prefab)\r\n    public bullet04: Prefab = null;\r\n    @property(Prefab)\r\n    public bullet05: Prefab = null;\r\n    @property\r\n    public shootTime = 0.3; // 射击周期 \r\n    @property\r\n    public bulletSpeed = 1; // 子弹速度\r\n    @property(Node)\r\n    bulletRoot: Node = null; \r\n\r\n    // prop\r\n    @property(Prefab)\r\n    public bulletPropM: Prefab = null;\r\n    @property(Prefab)\r\n    public bulletPropH: Prefab = null;\r\n    @property(Prefab)\r\n    public bulletPropS: Prefab = null;\r\n    @property\r\n    public bulletPropSpeed = 0.3;\r\n\r\n    // gamepage\r\n    @property(Node)\r\n    public gamePage: Node = null;\r\n    // @property(Node)\r\n    // public gameStartPage: Node = null;\r\n    @property(Node)\r\n    public gameOverPage: Node = null;\r\n    @property(Label)\r\n    public gameScore: Label = null;\r\n    @property(Label)\r\n    public gameOverScore: Label = null;\r\n    @property(Animation)\r\n    public overAnim: Animation = null;\r\n\r\n    public isGameStart = false;\r\n    \r\n    \r\n\r\n    private _curCreateEnemyTime = 0;\r\n    private _combinationInterval = Constant.Combination.PLAN1;\r\n\r\n    private _bulletType = Constant.BulletPropType.BULLET_INIT;\r\n    \r\n\r\n\r\n    private _curShootTime = 0;// 当前等待时间\r\n    public _isShooting = false;\r\n    private _score = 0;\r\n    \r\n\r\n    // audio\r\n    @property(AudioManager)\r\n    public audioEffect: AudioManager = null;\r\n\r\n    start() {\r\n        \r\n        this._init();\r\n    }\r\n    \r\n    public playAudioEffect(name: string){\r\n        this.audioEffect.play(name);\r\n    }\r\n    \r\n    public isShooting(v: boolean) {\r\n        // UIMain 中判断是否能开始发射子弹\r\n        this._isShooting = v\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        if(!this.isGameStart){\r\n            // console.info(\"not isGameStart\")\r\n            return;\r\n        }\r\n        \r\n        if(this.selfPlane.isDie){\r\n            this.gameOver();\r\n            return;\r\n        }\r\n\r\n        // createSelpBullet\r\n        this._curShootTime += deltaTime;\r\n        if (this._isShooting && this._curShootTime > this.shootTime) {\r\n            \r\n            if (this._bulletType === Constant.BulletPropType.BULLET_H) {\r\n                this.createPlayerBulletH();\r\n                // console.log(\"createPlayerBulletH\");\r\n            } else if (this._bulletType === Constant.BulletPropType.BULLET_S) {\r\n                this.createPlayerBulletS();\r\n                // console.log(\"createPlayerBulletS\");\r\n            } else if (this._bulletType === Constant.BulletPropType.BULLET_M) {\r\n                this.createPlayerBulletM();\r\n                // console.log(\"createPlayerBulletM\");\r\n            }   \r\n            else {\r\n                this.createPlayerBullet();\r\n                // console.log(\"createPlayerBullet\");\r\n            }\r\n            const name = 'bullet' + (this._bulletType % 2 + 1);\r\n            this.playAudioEffect(name);\r\n            this._curShootTime = 0;\r\n        }\r\n\r\n        // create enemy 随机选一个不会同时出现 也可以 _combinationInterval 出现是定时任务改的也有点问题\r\n        this._curCreateEnemyTime+=deltaTime;\r\n        if(this._combinationInterval===Constant.Combination.PLAN1 ){\r\n            if(this._curCreateEnemyTime > this.createEnemyTime){\r\n                this.createEnemyPlan1();\r\n                // console.log(\"_combinationInterval createEnemyPlan1\")\r\n                this._curCreateEnemyTime = 0;\r\n            }\r\n        }else if(this._combinationInterval === Constant.Combination.PLAN2){\r\n            if(this._curCreateEnemyTime > this.createEnemyTime * 0.9){\r\n\r\n                const randomCombination = math.randomRangeInt(1, 3);\r\n                if (randomCombination === Constant.Combination.PLAN2) {\r\n                    this.createEnemyPlan2();\r\n                } else {\r\n                    this.createEnemyPlan1();\r\n                }\r\n\r\n                this._curCreateEnemyTime = 0;\r\n            }\r\n\r\n        }else {\r\n            if(this._curCreateEnemyTime > this.createEnemyTime * 0.8){\r\n                const randomCombination = math.randomRangeInt(1, 4);\r\n                if (randomCombination === Constant.Combination.PLAN2) {\r\n                    this.createEnemyPlan3();\r\n                } else if (randomCombination === Constant.Combination.PLAN3) {\r\n                    this.createEnemyPlan2();\r\n                } else {\r\n                    this.createEnemyPlan1();\r\n                }\r\n\r\n                this._curCreateEnemyTime = 0;\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    public returnMain(){\r\n        this._curShootTime = 0;\r\n        this._curCreateEnemyTime = 0;\r\n        this._combinationInterval = Constant.Combination.PLAN1;\r\n        this._bulletType = Constant.BulletPropType.BULLET_INIT;\r\n        this.selfPlane.node.setPosition(0, 0, 15);\r\n        this._score = 0;\r\n    }\r\n\r\n\r\n\r\n    public gameStart(){\r\n        this.gameOverPage.active = false;\r\n        this.isGameStart = true;\r\n        this._changePlaneMode();\r\n        this._score = 0;\r\n        this.gameScore.string = this._score.toString();\r\n        this.selfPlane.init();\r\n    }\r\n\r\n\r\n\r\n    public gameReStart(){\r\n        this.gameStart();\r\n        this._curShootTime = 0;\r\n        this._curCreateEnemyTime = 0;\r\n        this._combinationInterval = Constant.Combination.PLAN1;\r\n        this._bulletType = Constant.BulletPropType.BULLET_INIT;\r\n        this.selfPlane.node.setPosition(0, 0, 15);\r\n    }\r\n    \r\n\r\n    public gameOver(){\r\n        this.isGameStart = false;\r\n        this.gamePage.active = false;\r\n        this.gameOverPage.active = true;\r\n        this.gameOverScore.string = this._score.toString();\r\n        this.overAnim.play();\r\n        this._isShooting = false;\r\n        // this.playerPlane.init();\r\n        this.unschedule(this._modeChanged);\r\n        this._destroyAll();\r\n    }\r\n\r\n    private _destroyAll(){\r\n        let children = this.node.children;\r\n        let length = children.length;\r\n        let i = 0;\r\n        for ( i = length - 1; i >= 0 ; i--) {\r\n            const child = children[i];\r\n            PoolManager.instance().putNode(child);\r\n            // child.destroy();\r\n        }\r\n\r\n        children = this.bulletRoot.children;\r\n        length = children.length;\r\n        for (i = length - 1; i >= 0 ; i--) {\r\n            const child = children[i];\r\n            PoolManager.instance().putNode(child);\r\n            // child.destroy();\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    public createEnemyPlan1(){\r\n        // 单个即是plan1\r\n        const whichEnemy = math.randomRangeInt(1, 3);\r\n        let prefab: Prefab = null;\r\n        let speed = 0;\r\n        if (whichEnemy === Constant.EnemyType.TYPE1) {\r\n            prefab = this.enemy01;\r\n            speed = this.enemy1Speed;\r\n        } else {\r\n            prefab = this.enemy02;\r\n            speed = this.enemy2Speed;\r\n        }\r\n\r\n        // const enemy = instantiate(prefab);\r\n        // enemy.setParent(this.node);\r\n        const enemy = PoolManager.instance().getNode(prefab, this.node);\r\n        const enemyComp = enemy.getComponent(EnemyPlane);\r\n        enemyComp.show(this, speed, true); // update parms\r\n\r\n        const randomPos = math.randomRangeInt(-25, 26);\r\n        enemy.setPosition(randomPos, 0, -40);\r\n    }\r\n\r\n    public createEnemyPlan2(){\r\n        // plan2 一字型\r\n        const enemyArray = new Array<Node>(5);\r\n        for (let i = 0; i < enemyArray.length; i++) {\r\n            // enemyArray[i] = instantiate(this.enemy01);\r\n            enemyArray[i] = PoolManager.instance().getNode(this.enemy01, this.node);\r\n            const element = enemyArray[i];\r\n            // element.parent = this.node;\r\n            // const enemy = \r\n            element.setPosition(-20 + i * 10, 0, -50);\r\n            const enemyComp = element.getComponent(EnemyPlane);\r\n            enemyComp.show(this, this.enemy1Speed, false);\r\n        }\r\n    }\r\n\r\n    public createEnemyPlan3(){\r\n        // v字型 7个\r\n        const enemyArray = new Array<Node>(7);\r\n        // 后续 x,z 考虑增加偏移\r\n        const combinationPos = [\r\n            -21, 0, -60,\r\n            -14, 0, -55,\r\n            -7, 0, -50,\r\n            0, 0, -45,\r\n            7, 0, -50,\r\n            14, 0, -55,\r\n            21, 0, -60,\r\n        ];\r\n\r\n        for (let i = 0; i < enemyArray.length; i++) {\r\n            // enemyArray[i] = instantiate(this.enemy02);\r\n            enemyArray[i] = PoolManager.instance().getNode(this.enemy02, this.node);\r\n            const element = enemyArray[i];\r\n            // element.parent = this.node;\r\n            const startIndex = i * 3;\r\n            element.setPosition(combinationPos[startIndex], combinationPos[startIndex + 1], combinationPos[startIndex + 2]);\r\n            const enemyComp = element.getComponent(EnemyPlane);\r\n            enemyComp.show(this, this.enemy2Speed, false);\r\n        }\r\n    }\r\n\r\n\r\n\r\n    public createEnemyEffect(pos: Vec3){\r\n        const effect = PoolManager.instance().getNode(this.enemyExplode, this.node);\r\n        effect.setPosition(pos);\r\n    }\r\n\r\n    private _init() {\r\n        // 第一发子弹不用等待\r\n        this._curShootTime = this.shootTime;\r\n        this.selfPlane.init();\r\n\r\n    }\r\n\r\n    public createPlayerBulletM(){\r\n        // const bullet = instantiate(this.bullet05);\r\n        const bullet = PoolManager.instance().getNode(this.bullet05, this.bulletRoot);\r\n        // bullet.setParent(this.bulletRoot);\r\n        const pos = this.selfPlane.node.position;\r\n        bullet.setPosition(pos.x, pos.y, pos.z - 7);\r\n        const bulletComp = bullet.getComponent(Bullet);\r\n        bulletComp.show(this.bulletSpeed, false);\r\n    }\r\n\r\n    public createPlayerBulletH(){\r\n        const pos = this.selfPlane.node.position;\r\n        // left\r\n        // const bullet1 = instantiate(this.bullet03);\r\n        const bullet1 = PoolManager.instance().getNode(this.bullet03, this.bulletRoot);\r\n        // bullet1.setParent(this.bulletRoot);\r\n        bullet1.setPosition(pos.x - 2.5, pos.y, pos.z - 7);\r\n        const bulletComp1 = bullet1.getComponent(Bullet);\r\n        bulletComp1.show(this.bulletSpeed, false);\r\n\r\n        // right\r\n        const bullet2 = PoolManager.instance().getNode(this.bullet03, this.bulletRoot);\r\n        // const bullet2 = instantiate(this.bullet03);\r\n        // bullet2.setParent(this.bulletRoot);\r\n        bullet2.setPosition(pos.x + 2.5, pos.y, pos.z - 7);\r\n        const bulletComp2 = bullet2.getComponent(Bullet);\r\n        bulletComp2.show(this.bulletSpeed, false);\r\n    }\r\n\r\n    public createPlayerBulletS(){\r\n        const pos = this.selfPlane.node.position;\r\n        // middle\r\n        const bullet = PoolManager.instance().getNode(this.bullet01, this.bulletRoot); \r\n        // const bullet = instantiate(this.bullet01);\r\n        // bullet.setParent(this.bulletRoot);\r\n        bullet.setPosition(pos.x, pos.y, pos.z - 7);\r\n        const bulletComp = bullet.getComponent(Bullet);\r\n        bulletComp.show(this.bulletSpeed, false);\r\n\r\n        // left\r\n        const bullet1 = PoolManager.instance().getNode(this.bullet01, this.bulletRoot); \r\n        // const bullet1 = instantiate(this.bullet01);\r\n        // bullet1.setParent(this.bulletRoot);\r\n        bullet1.setPosition(pos.x - 4, pos.y, pos.z - 7);\r\n        const bulletComp1 = bullet1.getComponent(Bullet);\r\n        bulletComp1.show(this.bulletSpeed, false, Constant.Direction.LEFT);\r\n\r\n        // right\r\n        // const bullet2 = instantiate(this.bullet01);\r\n        const bullet2 = PoolManager.instance().getNode(this.bullet01, this.bulletRoot);\r\n        // bullet2.setParent(this.bulletRoot);\r\n        bullet2.setPosition(pos.x + 4, pos.y, pos.z - 7);\r\n        const bulletComp2 = bullet2.getComponent(Bullet);\r\n        bulletComp2.show(this.bulletSpeed, false, Constant.Direction.RIGHT);\r\n    }\r\n\r\n    public createPlayerBullet(){\r\n        const bullet = PoolManager.instance().getNode(this.bullet01, this.bulletRoot);\r\n        // const bullet = instantiate(this.bullet01);\r\n        // bullet.setParent(this.bulletRoot)\r\n        // this.node.addChild(bullet);\r\n        const pos = this.selfPlane.node.position;\r\n        bullet.setPosition(pos.x, pos.y, pos.z - 7);\r\n        const bulletComp = bullet.getComponent(Bullet);\r\n        bulletComp.show(this.bulletSpeed, false);\r\n    }\r\n\r\n    public createEnemyBullet(targetPos: Vec3){\r\n        const bullet = PoolManager.instance().getNode(this.bullet02, this.bulletRoot);\r\n        // const bullet = instantiate(this.bullet02);\r\n        bullet.setParent(this.node);\r\n        bullet.setPosition(targetPos.x, targetPos.y, targetPos.z + 6);\r\n        const bulletComp = bullet.getComponent(Bullet);\r\n        bulletComp.show(1, true);\r\n    }\r\n\r\n    public createSelpBullet() {\r\n        // 创建子弹\r\n        const bullet = PoolManager.instance().getNode(this.bullet01, this.bulletRoot);\r\n        // const bullet = instantiate(this.bullet01) // 实例化预制件\r\n        // this.node.addChild(bullet);\r\n        // bullet.setParent(this.bulletRoot) // 子弹实例放入子弹根节点\r\n        const pos = this.selfPlane.node.position; // 获取飞机位置 找到子弹初始位置\r\n        bullet.setPosition(pos.x,pos.y,pos.z - 5);\r\n        const bulletComp = bullet.getComponent(Bullet)// 获取节点上的组件 -- 子弹类\r\n        // console.info(\"bulletComp\", bulletComp)\r\n        bulletComp.bulletSpeed=this.bulletSpeed // 更新子弹移动速度\r\n        console.info(\"create bullet ok\",pos.x,pos.y,pos.z - 5,bullet.active)\r\n    }\r\n\r\n    // createBulletProp\r\n    public createBulletProp(){\r\n        // 这一块的逻辑可能需要更改 道具也许不应该是 永久的\r\n        const randomProp = math.randomRangeInt(1, 4);\r\n        \r\n        let prefab: Prefab = null;\r\n        if(randomProp === Constant.BulletPropType.BULLET_H){\r\n            prefab = this.bulletPropH;\r\n        } else if(randomProp === Constant.BulletPropType.BULLET_S){\r\n            prefab = this.bulletPropS;\r\n        } else {\r\n            prefab = this.bulletPropM;\r\n        }\r\n\r\n        const prop = PoolManager.instance().getNode(prefab, this.node);\r\n        // const prop = instantiate(prefab);\r\n        // prop.setParent(this.node);\r\n\r\n        prop.setPosition(15, 0, -40);\r\n        console.info(\"create bulletPropM \",prefab)\r\n        const propComp = prop.getComponent(BulletProp);\r\n        propComp.show(this, this.bulletPropSpeed);\r\n    }\r\n\r\n    public changeBulletType(type: number){\r\n        this._bulletType = type;\r\n        console.log(\"_bulletType\",this._bulletType)\r\n    }\r\n\r\n    private _modeChanged(){\r\n        this._combinationInterval ++; // update combination\r\n        this.createBulletProp();    // update \r\n    }\r\n\r\n    public addScore(){\r\n        this._score ++\r\n    }\r\n\r\n    // all 模式改变 schedule\r\n    private _changePlaneMode(){\r\n        // _changePlaneMode\r\n        this.schedule(this._modeChanged, 10,  macro.REPEAT_FOREVER); //cc 调度器 callback  间隔/s 次数  macro.REPEAT_FOREVER 无止境\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n"]}