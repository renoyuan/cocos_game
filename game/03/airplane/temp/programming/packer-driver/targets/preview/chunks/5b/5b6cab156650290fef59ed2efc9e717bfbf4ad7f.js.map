{"version":3,"sources":["file:///F:/cocos/cocos_game/game/03/airplane/assets/script/framework/PoolManager.ts"],"names":["_decorator","NodePool","instantiate","ccclass","property","PoolManager","_dictPool","_dictPrefab","instance","_instance","getNode","prefab","parent","name","data","node","pool","size","get","active","putNode","put"],"mappings":";;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAqCC,MAAAA,Q,OAAAA,Q;AAAUC,MAAAA,W,OAAAA,W;;;;;;;;;OAClD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBJ,U;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;6BAWaK,W,WADZF,OAAO,CAAC,aAAD,C,2BAAR,MACaE,WADb,CACyB;AAAA;AAAA,eAUbC,SAVa,GAUU,EAVV;AAAA,eAWbC,WAXa,GAWc,EAXd;AAAA;;AAEC,eAARC,QAAQ,GAAE;AACpB,cAAG,CAAC,KAAKC,SAAT,EAAmB;AACf,iBAAKA,SAAL,GAAiB,IAAIJ,WAAJ,EAAjB;AACH;;AAED,iBAAO,KAAKI,SAAZ;AACH;;AAOMC,QAAAA,OAAO,CAACC,MAAD,EAAiBC,MAAjB,EAA8B;AACxC,cAAIC,IAAI,GAAGF,MAAM,CAACG,IAAP,CAAYD,IAAvB,CADwC,CAExC;;AACA,cAAIE,IAAU,GAAG,IAAjB;AACA,eAAKR,WAAL,CAAiBM,IAAjB,IAAyBF,MAAzB;AACA,cAAMK,IAAI,GAAG,KAAKV,SAAL,CAAeO,IAAf,CAAb;;AACA,cAAIG,IAAJ,EAAU;AACN,gBAAIA,IAAI,CAACC,IAAL,KAAc,CAAlB,EAAqB;AACjBF,cAAAA,IAAI,GAAGC,IAAI,CAACE,GAAL,EAAP;AACH,aAFD,MAEO;AACHH,cAAAA,IAAI,GAAGb,WAAW,CAACS,MAAD,CAAlB;AACH;AACJ,WAND,MAMO;AACH,iBAAKL,SAAL,CAAeO,IAAf,IAAuB,IAAIZ,QAAJ,EAAvB;AACAc,YAAAA,IAAI,GAAGb,WAAW,CAACS,MAAD,CAAlB;AACH;;AAEDI,UAAAA,IAAI,CAACH,MAAL,GAAcA,MAAd;AACAG,UAAAA,IAAI,CAACI,MAAL,GAAc,IAAd;AACA,iBAAOJ,IAAP;AACH;;AAEMK,QAAAA,OAAO,CAACL,IAAD,EAAY;AACtB,cAAIF,IAAI,GAAGE,IAAI,CAACF,IAAhB,CADsB,CAEtB;;AACAE,UAAAA,IAAI,CAACH,MAAL,GAAc,IAAd;;AACA,cAAI,CAAC,KAAKN,SAAL,CAAeO,IAAf,CAAL,EAA2B;AACvB,iBAAKP,SAAL,CAAeO,IAAf,IAAuB,IAAIZ,QAAJ,EAAvB;AACH;;AAED,eAAKK,SAAL,CAAeO,IAAf,EAAqBQ,GAArB,CAAyBN,IAAzB;AACH;;AA9CoB,O,UAYNN,S;AAqCnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["\r\nimport { _decorator, Component, Node, Prefab, NodePool, instantiate } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * Predefined variables\r\n * Name = PoolManager\r\n * DateTime = Fri Nov 26 2021 18:00:45 GMT+0800 (China Standard Time)\r\n * Author = mywayday\r\n * FileBasename = PoolManager.ts\r\n * FileBasenameNoExtension = PoolManager\r\n * URL = db://assets/script/framework/PoolManager.ts\r\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/en/\r\n *\r\n */\r\n\r\ninterface IDictPool {\r\n    [name: string]: NodePool;\r\n}\r\n\r\ninterface IDictPrefab {\r\n    [name: string]: Prefab;\r\n}\r\n\r\n@ccclass('PoolManager')\r\nexport class PoolManager {\r\n\r\n    public static instance(){\r\n        if(!this._instance){\r\n            this._instance = new PoolManager();\r\n        }\r\n\r\n        return this._instance;\r\n    }\r\n\r\n    private _dictPool: IDictPool = {};\r\n    private _dictPrefab: IDictPrefab = {};\r\n    private static _instance: PoolManager;\r\n\r\n\r\n    public getNode(prefab: Prefab, parent: Node){\r\n        let name = prefab.data.name;\r\n        // console.log('get node   ' + name);\r\n        let node: Node = null;\r\n        this._dictPrefab[name] = prefab;\r\n        const pool = this._dictPool[name];\r\n        if (pool) {\r\n            if (pool.size() > 0) {\r\n                node = pool.get();\r\n            } else {\r\n                node = instantiate(prefab);\r\n            }\r\n        } else {\r\n            this._dictPool[name] = new NodePool();\r\n            node = instantiate(prefab);\r\n        }\r\n\r\n        node.parent = parent;\r\n        node.active = true;\r\n        return node;\r\n    }\r\n\r\n    public putNode(node: Node){\r\n        let name = node.name;\r\n        // console.log('put node   ' + name);\r\n        node.parent = null;\r\n        if (!this._dictPool[name]) {\r\n            this._dictPool[name] = new NodePool();\r\n        }\r\n\r\n        this._dictPool[name].put(node);\r\n    }\r\n}\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/en/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/en/scripting/ccclass.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/en/scripting/life-cycle-callbacks.html\r\n */\r\n"]}