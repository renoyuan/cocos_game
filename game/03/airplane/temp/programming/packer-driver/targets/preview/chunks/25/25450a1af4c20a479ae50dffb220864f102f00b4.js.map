{"version":3,"sources":["file:///F:/cocos/cocos_game/game/03/airplane/assets/script/plane/EnemyPlane.ts"],"names":["_decorator","Component","Collider","Constant","PoolManager","ccclass","property","OUTOFBOUNCE","EnemyPlane","_enemySpeed","_needBullet","_gameManager","_currCreateBulletTime","onEnable","collider","getComponent","on","_onTriggerEnter","onDisable","off","update","deltaTime","pos","node","position","movePos","z","setPosition","x","y","createBulletTime","createEnemyBullet","instance","putNode","show","gameManager","speed","needBullet","event","collisionGroup","otherCollider","getGroup","CollisionType","SELF_PLANE","SELF_BULLET","playAudioEffect","addScore","createEnemyEffect"],"mappings":"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","sourcesContent":["\r\nimport { _decorator, Component, Node, sp, ITriggerEvent, Collider } from 'cc';\r\nimport { Constant } from '../framework/Constant';\r\nimport { GameManager } from '../framework/GameManager';\r\nimport { PoolManager } from '../framework/PoolManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * Predefined variables\r\n * Name = EnemyPlane\r\n * DateTime = Mon Nov 15 2021 18:00:28 GMT+0800 (China Standard Time)\r\n * Author = mywayday\r\n * FileBasename = EnemyPlane.ts\r\n * FileBasenameNoExtension = EnemyPlane\r\n * URL = db://assets/script/plane/EnemyPlane.ts\r\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/en/\r\n *\r\n */\r\n\r\nconst OUTOFBOUNCE = 50;\r\n\r\n@ccclass('EnemyPlane')\r\nexport class EnemyPlane extends Component {\r\n    @property\r\n    public createBulletTime = 0.5;\r\n\r\n    private _enemySpeed = 0;\r\n    private _needBullet = false;\r\n    private _gameManager: GameManager = null;\r\n\r\n    private _currCreateBulletTime = 0;\r\n\r\n    onEnable () {\r\n        const collider = this.getComponent(Collider);\r\n        collider.on('onTriggerEnter', this._onTriggerEnter, this);\r\n    }\r\n\r\n    onDisable () {\r\n        const collider = this.getComponent(Collider);\r\n        collider.off('onTriggerEnter', this._onTriggerEnter, this);\r\n    }\r\n\r\n    update (deltaTime: number) {\r\n        const pos = this.node.position;\r\n        const movePos = pos.z + this._enemySpeed;\r\n        this.node.setPosition(pos.x, pos.y, movePos);\r\n\r\n        if(this._needBullet){\r\n            this._currCreateBulletTime += deltaTime;\r\n            if(this._currCreateBulletTime > this.createBulletTime){\r\n                this._gameManager.createEnemyBullet(this.node.position);\r\n                this._currCreateBulletTime = 0;\r\n            }\r\n        }\r\n\r\n        if(movePos > OUTOFBOUNCE){\r\n            PoolManager.instance().putNode(this.node);\r\n            // this.node.destroy();\r\n        }\r\n    }\r\n\r\n    show(gameManager: GameManager, speed: number, needBullet: boolean){\r\n        this._gameManager = gameManager;\r\n        this._enemySpeed = speed;\r\n        this._needBullet = needBullet;\r\n    }\r\n\r\n    private _onTriggerEnter(event: ITriggerEvent){\r\n        const collisionGroup = event.otherCollider.getGroup();\r\n        if(collisionGroup === Constant.CollisionType.SELF_PLANE || collisionGroup === Constant.CollisionType.SELF_BULLET){\r\n            // console.log('trigger enemy destroy');\r\n            this._gameManager.playAudioEffect('enemy');\r\n            PoolManager.instance().putNode(this.node);\r\n            // this.node.destroy();\r\n            this._gameManager.addScore();\r\n            this._gameManager.createEnemyEffect(this.node.position);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/en/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/en/scripting/ccclass.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/en/scripting/life-cycle-callbacks.html\r\n */\r\n"]}