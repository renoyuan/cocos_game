{"version":3,"sources":["file:///F:/cocos/cocos_game/game/03/airplane/assets/script/framework/GameManager.ts"],"names":["_decorator","Component","instantiate","Node","Prefab","math","macro","Bullet","BulletProp","Constant","EnemyPlane","ccclass","property","GameManager","score","_curCreateEnemyTime","_combinationInterval","Combination","PLAN1","_bulletType","BulletPropType","BULLET_INIT","_curShootTime","_isShooting","start","_init","_changePlaneMode","update","deltaTime","shootTime","BULLET_H","createPlayerBulletH","console","log","BULLET_S","createPlayerBulletS","BULLET_M","createPlayerBulletM","createPlayerBullet","createEnemyTime","createEnemyPlan1","PLAN2","randomCombination","randomRangeInt","createEnemyPlan2","createEnemyPlan3","PLAN3","whichEnemy","prefab","speed","EnemyType","TYPE1","enemy01","enemy1Speed","enemy02","enemy2Speed","enemy","setParent","node","enemyComp","getComponent","show","randomPos","setPosition","enemyArray","Array","i","length","element","parent","combinationPos","startIndex","isShooting","v","bullet","bullet05","bulletRoot","pos","selfPlane","position","x","y","z","bulletComp","bulletSpeed","bullet1","bullet03","bulletComp1","bullet2","bulletComp2","bullet01","Direction","LEFT","RIGHT","createEnemyBullet","targetPos","bullet02","createSelpBullet","info","active","createBulletProp","randomProp","bulletPropH","bulletPropS","bulletPropM","prop","propComp","bulletPropSpeed","changeBulletType","type","_modeChanged","addScore","schedule","REPEAT_FOREVER"],"mappings":"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","sourcesContent":["import { _decorator, Component, instantiate, Node, Prefab, math,Vec3, macro } from 'cc';\r\nimport { Bullet } from '../bullet/Bullet';\r\nimport { BulletProp } from '../bullet/BulletProp';\r\nimport { Constant } from './Constant';\r\nimport { EnemyPlane } from '../plane/EnemyPlane';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('GameManager')\r\nexport class GameManager extends Component {\r\n    // palyer plane\r\n    @property(Node)\r\n    public selfPlane: Node = null;\r\n\r\n    public score = 0;\r\n\r\n    //bullet\r\n    @property(Prefab)\r\n    public bullet01: Prefab = null;\r\n    @property(Prefab)\r\n    public bullet02: Prefab = null;\r\n    @property(Prefab)\r\n    public bullet03: Prefab = null;\r\n    @property(Prefab)\r\n    public bullet04: Prefab = null;\r\n    @property(Prefab)\r\n    public bullet05: Prefab = null;\r\n    @property\r\n    public shootTime = 0.3; // 射击周期 \r\n    @property\r\n    public bulletSpeed = 1; // 子弹速度\r\n    @property(Node)\r\n    bulletRoot: Node = null; \r\n\r\n    // prop\r\n    @property(Prefab)\r\n    public bulletPropM: Prefab = null;\r\n    @property(Prefab)\r\n    public bulletPropH: Prefab = null;\r\n    @property(Prefab)\r\n    public bulletPropS: Prefab = null;\r\n    @property\r\n    public bulletPropSpeed = 0.3;\r\n\r\n\r\n\r\n    // enemy plane\r\n    @property(Prefab)\r\n    public enemy01: Prefab = null;\r\n    @property(Prefab)\r\n    public enemy02: Prefab = null;\r\n    \r\n    @property\r\n    public createEnemyTime = 1;\r\n    @property\r\n    public enemy1Speed = 0.5;\r\n    @property\r\n    public enemy2Speed = 0.7;\r\n\r\n    private _curCreateEnemyTime = 0;\r\n    private _combinationInterval = Constant.Combination.PLAN1;\r\n\r\n    private _bulletType = Constant.BulletPropType.BULLET_INIT;\r\n    \r\n\r\n\r\n    private _curShootTime = 0;// 当前等待时间\r\n    public _isShooting = false;\r\n    \r\n\r\n    start() {\r\n        this._init();\r\n        this._changePlaneMode();\r\n        // this._bulletType = Constant.BulletPropType.BULLET_M;\r\n        // this.createBulletProp();\r\n        // this._bulletType = Constant.BulletPropType.BULLET_INIT;\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    update(deltaTime: number) {\r\n        // createSelpBullet\r\n        this._curShootTime += deltaTime;\r\n        if (this._isShooting && this._curShootTime > this.shootTime) {\r\n            \r\n            if (this._bulletType === Constant.BulletPropType.BULLET_H) {\r\n                this.createPlayerBulletH();\r\n                console.log(\"createPlayerBulletH\");\r\n            } else if (this._bulletType === Constant.BulletPropType.BULLET_S) {\r\n                this.createPlayerBulletS();\r\n                console.log(\"createPlayerBulletS\");\r\n            } else if (this._bulletType === Constant.BulletPropType.BULLET_M) {\r\n                this.createPlayerBulletM();\r\n                console.log(\"createPlayerBulletM\");\r\n            }   \r\n            else {\r\n                this.createPlayerBullet();\r\n                console.log(\"createPlayerBullet\");\r\n            }\r\n\r\n            \r\n\r\n            this._curShootTime = 0;\r\n        }\r\n\r\n        // create enemy 随机选一个不会同时出现 也可以 _combinationInterval 出现是定时任务改的也有点问题\r\n        this._curCreateEnemyTime+=deltaTime;\r\n        \r\n        if(this._combinationInterval===Constant.Combination.PLAN1 ){\r\n            if(this._curCreateEnemyTime > this.createEnemyTime){\r\n                this.createEnemyPlan1();\r\n                // console.log(\"_combinationInterval createEnemyPlan1\")\r\n                this._curCreateEnemyTime = 0;\r\n            }\r\n        }else if(this._combinationInterval === Constant.Combination.PLAN2){\r\n            if(this._curCreateEnemyTime > this.createEnemyTime * 0.9){\r\n\r\n                const randomCombination = math.randomRangeInt(1, 3);\r\n                if (randomCombination === Constant.Combination.PLAN2) {\r\n                    this.createEnemyPlan2();\r\n                } else {\r\n                    this.createEnemyPlan1();\r\n                }\r\n\r\n                this._curCreateEnemyTime = 0;\r\n            }\r\n\r\n        }else {\r\n            if(this._curCreateEnemyTime > this.createEnemyTime * 0.8){\r\n                const randomCombination = math.randomRangeInt(1, 4);\r\n                if (randomCombination === Constant.Combination.PLAN2) {\r\n                    this.createEnemyPlan3();\r\n                } else if (randomCombination === Constant.Combination.PLAN3) {\r\n                    this.createEnemyPlan2();\r\n                } else {\r\n                    this.createEnemyPlan1();\r\n                }\r\n\r\n                this._curCreateEnemyTime = 0;\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n\r\n\r\n    public createEnemyPlan1(){\r\n        // 单个即是plan1\r\n        const whichEnemy = math.randomRangeInt(1, 3);\r\n        let prefab: Prefab = null;\r\n        let speed = 0;\r\n        if (whichEnemy === Constant.EnemyType.TYPE1) {\r\n            prefab = this.enemy01;\r\n            speed = this.enemy1Speed;\r\n        } else {\r\n            prefab = this.enemy02;\r\n            speed = this.enemy2Speed;\r\n        }\r\n\r\n        const enemy = instantiate(prefab);\r\n        enemy.setParent(this.node);\r\n        const enemyComp = enemy.getComponent(EnemyPlane);\r\n        enemyComp.show(this, speed, true); // update parms\r\n\r\n        const randomPos = math.randomRangeInt(-25, 26);\r\n        enemy.setPosition(randomPos, 0, -40);\r\n    }\r\n\r\n    public createEnemyPlan2(){\r\n        // plan2 一字型\r\n        const enemyArray = new Array<Node>(5);\r\n        for (let i = 0; i < enemyArray.length; i++) {\r\n            enemyArray[i] = instantiate(this.enemy01);\r\n            const element = enemyArray[i];\r\n            element.parent = this.node;\r\n            element.setPosition(-20 + i * 10, 0, -50);\r\n            const enemyComp = element.getComponent(EnemyPlane);\r\n            enemyComp.show(this, this.enemy1Speed, false);\r\n        }\r\n    }\r\n\r\n    public createEnemyPlan3(){\r\n        // v字型 7个\r\n        const enemyArray = new Array<Node>(7);\r\n        // 后续 x,z 考虑增加偏移\r\n        const combinationPos = [\r\n            -21, 0, -60,\r\n            -14, 0, -55,\r\n            -7, 0, -50,\r\n            0, 0, -45,\r\n            7, 0, -50,\r\n            14, 0, -55,\r\n            21, 0, -60,\r\n        ];\r\n\r\n        for (let i = 0; i < enemyArray.length; i++) {\r\n            enemyArray[i] = instantiate(this.enemy02);\r\n            const element = enemyArray[i];\r\n            element.parent = this.node;\r\n            const startIndex = i * 3;\r\n            element.setPosition(combinationPos[startIndex], combinationPos[startIndex + 1], combinationPos[startIndex + 2]);\r\n            const enemyComp = element.getComponent(EnemyPlane);\r\n            enemyComp.show(this, this.enemy2Speed, false);\r\n        }\r\n    }\r\n\r\n\r\n    public isShooting(v: boolean) {\r\n        // UIMain 中判断是否能开始发射子弹\r\n        this._isShooting = v\r\n    }\r\n\r\n\r\n    private _init() {\r\n        // 第一发子弹不用等待\r\n        this._curShootTime = this.shootTime;\r\n\r\n    }\r\n\r\n    public createPlayerBulletM(){\r\n        const bullet = instantiate(this.bullet05);\r\n        bullet.setParent(this.bulletRoot);\r\n        const pos = this.selfPlane.position;\r\n        bullet.setPosition(pos.x, pos.y, pos.z - 7);\r\n        const bulletComp = bullet.getComponent(Bullet);\r\n        bulletComp.show(this.bulletSpeed, false);\r\n    }\r\n\r\n    public createPlayerBulletH(){\r\n        const pos = this.selfPlane.position;\r\n        // left\r\n        const bullet1 = instantiate(this.bullet03);\r\n        bullet1.setParent(this.bulletRoot);\r\n        bullet1.setPosition(pos.x - 2.5, pos.y, pos.z - 7);\r\n        const bulletComp1 = bullet1.getComponent(Bullet);\r\n        bulletComp1.show(this.bulletSpeed, false);\r\n\r\n        // right\r\n        const bullet2 = instantiate(this.bullet03);\r\n        bullet2.setParent(this.bulletRoot);\r\n        bullet2.setPosition(pos.x + 2.5, pos.y, pos.z - 7);\r\n        const bulletComp2 = bullet2.getComponent(Bullet);\r\n        bulletComp2.show(this.bulletSpeed, false);\r\n    }\r\n\r\n    public createPlayerBulletS(){\r\n        const pos = this.selfPlane.position;\r\n        // middle\r\n        const bullet = instantiate(this.bullet01);\r\n        bullet.setParent(this.bulletRoot);\r\n        bullet.setPosition(pos.x, pos.y, pos.z - 7);\r\n        const bulletComp = bullet.getComponent(Bullet);\r\n        bulletComp.show(this.bulletSpeed, false);\r\n\r\n        // left\r\n        const bullet1 = instantiate(this.bullet01);\r\n        bullet1.setParent(this.bulletRoot);\r\n        bullet1.setPosition(pos.x - 4, pos.y, pos.z - 7);\r\n        const bulletComp1 = bullet1.getComponent(Bullet);\r\n        bulletComp1.show(this.bulletSpeed, false, Constant.Direction.LEFT);\r\n\r\n        // right\r\n        const bullet2 = instantiate(this.bullet01);\r\n        bullet2.setParent(this.bulletRoot);\r\n        bullet2.setPosition(pos.x + 4, pos.y, pos.z - 7);\r\n        const bulletComp2 = bullet2.getComponent(Bullet);\r\n        bulletComp2.show(this.bulletSpeed, false, Constant.Direction.RIGHT);\r\n    }\r\n\r\n    public createPlayerBullet(){\r\n        const bullet = instantiate(this.bullet01);\r\n        bullet.setParent(this.bulletRoot)\r\n        // this.node.addChild(bullet);\r\n        const pos = this.selfPlane.position;\r\n        bullet.setPosition(pos.x, pos.y, pos.z - 7);\r\n        const bulletComp = bullet.getComponent(Bullet);\r\n        bulletComp.show(this.bulletSpeed, false);\r\n    }\r\n\r\n    public createEnemyBullet(targetPos: Vec3){\r\n        const bullet = instantiate(this.bullet02);\r\n        bullet.setParent(this.node);\r\n        bullet.setPosition(targetPos.x, targetPos.y, targetPos.z + 6);\r\n        const bulletComp = bullet.getComponent(Bullet);\r\n        bulletComp.show(1, true);\r\n    }\r\n\r\n    public createSelpBullet() {\r\n        // 创建子弹\r\n        const bullet = instantiate(this.bullet01) // 实例化预制件\r\n        // this.node.addChild(bullet);\r\n        bullet.setParent(this.bulletRoot) // 子弹实例放入子弹根节点\r\n        const pos = this.selfPlane.position; // 获取飞机位置 找到子弹初始位置\r\n        bullet.setPosition(pos.x,pos.y,pos.z - 5);\r\n        const bulletComp = bullet.getComponent(Bullet)// 获取节点上的组件 -- 子弹类\r\n        // console.info(\"bulletComp\", bulletComp)\r\n        bulletComp.bulletSpeed=this.bulletSpeed // 更新子弹移动速度\r\n        console.info(\"create bullet ok\",pos.x,pos.y,pos.z - 5,bullet.active)\r\n    }\r\n\r\n    // createBulletProp\r\n    public createBulletProp(){\r\n        // 这一块的逻辑可能需要更改 道具也许不应该是 永久的\r\n        const randomProp = math.randomRangeInt(1, 4);\r\n        let prefab: Prefab = null;\r\n        if(randomProp === Constant.BulletPropType.BULLET_H){\r\n            prefab = this.bulletPropH;\r\n        } else if(randomProp === Constant.BulletPropType.BULLET_H){\r\n            prefab = this.bulletPropS;\r\n        } else {\r\n            prefab = this.bulletPropM;\r\n        }\r\n\r\n        const prop = instantiate(prefab);\r\n\r\n        prop.setParent(this.node);\r\n        prop.setPosition(15, 0, -40);\r\n        console.info(\"create bulletPropM \",prefab)\r\n        const propComp = prop.getComponent(BulletProp);\r\n        propComp.show(this, this.bulletPropSpeed);\r\n    }\r\n\r\n    public changeBulletType(type: number){\r\n        this._bulletType = type;\r\n        console.log(\"_bulletType\",this._bulletType)\r\n    }\r\n\r\n    private _modeChanged(){\r\n        // this._combinationInterval ++; // update combination\r\n        // this.createBulletProp();    // update \r\n    }\r\n\r\n    public addScore(){\r\n        this.score ++\r\n    }\r\n\r\n    // all 模式改变 schedule\r\n    private _changePlaneMode(){\r\n        // _changePlaneMode\r\n        this.schedule(this._modeChanged, 10,  macro.REPEAT_FOREVER); //cc 调度器 callback  间隔/s 次数  macro.REPEAT_FOREVER 无止境\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n"]}