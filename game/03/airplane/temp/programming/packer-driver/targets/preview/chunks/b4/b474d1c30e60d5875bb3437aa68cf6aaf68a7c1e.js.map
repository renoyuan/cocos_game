{"version":3,"sources":["file:///F:/cocos/cocos_game/game/03/airplane/assets/script/plane/SelfPlane.ts"],"names":["_decorator","Component","Node","Collider","AudioSource","Constant","ccclass","property","SelfPlane","lifeValue","isDie","_currLife","_audioEffect","init","explode","active","blood","bloodFace","setScale","start","getComponent","onDisable","collider","off","_onTriggerEnter","onEnable","on","event","collisionGroup","otherCollider","getGroup","ColliderType","ENEMY","ENEMY_BULLET","play"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAgDC,MAAAA,Q,OAAAA,Q;AAASC,MAAAA,W,OAAAA,W;;AAChFC,MAAAA,Q,iBAAAA,Q;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;2BAGjBQ,S,WADZF,OAAO,CAAC,WAAD,C,UAEHC,QAAQ,CAACL,IAAD,C,UAERK,QAAQ,CAACL,IAAD,C,UAERK,QAAQ,CAACL,IAAD,C,2BANb,MACaM,SADb,SAC+BP,SAD/B,CACyC;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eAO9BQ,SAP8B,GAOlB,CAPkB;AAAA,eAQ9BC,KAR8B,GAQtB,KARsB;AAAA,eAU7BC,SAV6B,GAUjB,CAViB;AAAA,eAW7BC,YAX6B,GAWD,IAXC;AAAA;;AAa9BC,QAAAA,IAAI,GAAE;AACT,eAAKF,SAAL,GAAiB,KAAKF,SAAtB;AACA,eAAKC,KAAL,GAAa,KAAb;AACA,eAAKI,OAAL,CAAaC,MAAb,GAAsB,KAAtB;AACA,eAAKC,KAAL,CAAWD,MAAX,GAAoB,IAApB;AACA,eAAKE,SAAL,CAAeC,QAAf,CAAwB,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B;AACH;;AACDC,QAAAA,KAAK,GAAE;AACH,eAAKP,YAAL,GAAoB,KAAKQ,YAAL,CAAkBhB,WAAlB,CAApB;AACH,SAtBoC,CAwBrC;AAGA;;;AACAiB,QAAAA,SAAS,GAAE;AACP,cAAMC,QAAQ,GAAC,KAAKF,YAAL,CAAkBjB,QAAlB,CAAf;AACAmB,UAAAA,QAAQ,CAACC,GAAT,CAAa,gBAAb,EAA8B,KAAKC,eAAnC,EAAmD,IAAnD;AACH;;AAEDC,QAAAA,QAAQ,GAAE;AACN,cAAMH,QAAQ,GAAC,KAAKF,YAAL,CAAkBjB,QAAlB,CAAf;AACAmB,UAAAA,QAAQ,CAACI,EAAT,CAAY,gBAAZ,EAA6B,KAAKF,eAAlC,EAAkD,IAAlD;AACH;;AAEOA,QAAAA,eAAe,CAACG,KAAD,EAAqB;AACxC,cAAMC,cAAc,GAAGD,KAAK,CAACE,aAAN,CAAoBC,QAApB,EAAvB;;AACA,cAAGF,cAAc,IAAE;AAAA;AAAA,oCAASG,YAAT,CAAsBC,KAAtC,IAA8CJ,cAAc,IAAE;AAAA;AAAA,oCAASG,YAAT,CAAsBE,YAAvF,EAAqG;AACjG,iBAAKtB,SAAL;AACA,iBAAKM,SAAL,CAAeC,QAAf,CAAwB,KAAKP,SAAL,GAAiB,KAAKF,SAA9C,EAAyD,CAAzD,EAA4D,CAA5D;;AACA,gBAAG,KAAKE,SAAL,IAAiB,CAApB,EAAsB;AAClB,mBAAKD,KAAL,GAAa,IAAb;;AACA,mBAAKE,YAAL,CAAkBsB,IAAlB;;AACA,mBAAKpB,OAAL,CAAaC,MAAb,GAAsB,IAAtB;AACA,mBAAKC,KAAL,CAAWD,MAAX,GAAoB,KAApB,CAJkB,CAKlB;AACH;AACJ;AAEJ;;AApDoC,O;;;;;iBAEd,I;;;;;;;iBAEE,I;;;;;;;iBAEJ,I","sourcesContent":["import { _decorator, Component, Node, Touch,EventTouch,EventTarget,input,Input, Collider,AudioSource, ITriggerEvent    } from 'cc';\r\nimport { Constant } from '../framework/Constant';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('SelfPlane')\r\nexport class SelfPlane extends Component {\r\n    @property(Node)\r\n    public explode: Node = null;\r\n    @property(Node)\r\n    public bloodFace: Node = null;\r\n    @property(Node)\r\n    public blood: Node = null;\r\n    public lifeValue = 5;\r\n    public isDie = false;\r\n\r\n    private _currLife = 0;\r\n    private _audioEffect: AudioSource = null;\r\n\r\n    public init(){\r\n        this._currLife = this.lifeValue;\r\n        this.isDie = false;\r\n        this.explode.active = false;\r\n        this.blood.active = true;\r\n        this.bloodFace.setScale(1, 1, 1);\r\n    }\r\n    start(){\r\n        this._audioEffect = this.getComponent(AudioSource);\r\n    }\r\n\r\n    // update(deltaTime: number) {\r\n        \r\n        \r\n    // }\r\n    onDisable(){\r\n        const collider=this.getComponent(Collider);\r\n        collider.off('onTriggerEnter',this._onTriggerEnter,this);\r\n    }\r\n\r\n    onEnable(){\r\n        const collider=this.getComponent(Collider);\r\n        collider.on('onTriggerEnter',this._onTriggerEnter,this);\r\n    }\r\n\r\n    private _onTriggerEnter(event:ITriggerEvent){\r\n        const collisionGroup = event.otherCollider.getGroup();\r\n        if(collisionGroup==Constant.ColliderType.ENEMY ||collisionGroup==Constant.ColliderType.ENEMY_BULLET ){\r\n            this._currLife --;\r\n            this.bloodFace.setScale(this._currLife / this.lifeValue, 1, 1);\r\n            if(this._currLife <=0){\r\n                this.isDie = true;\r\n                this._audioEffect.play();\r\n                this.explode.active = true;\r\n                this.blood.active = false;\r\n                // console.log('self plane is die');\r\n            }\r\n        }\r\n\r\n    }\r\n}\r\n\r\n\r\n"]}