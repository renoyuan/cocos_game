{"version":3,"sources":["file:///F:/cocos/cocos_game/game/03/airplane/assets/script/bullet/Bullet.ts"],"names":["_decorator","Collider","Component","Constant","PoolManager","ccclass","property","OUTRANGE","ENEMYOUTRANGE","Bullet","bulletSpeed","_direction","Direction","MIDDLE","_isEnemyBullet","onEnable","collider","getComponent","on","_onTriggerEnter","onDisable","off","start","update","deltaTime","pos","node","position","moveLength","z","setPosition","x","y","instance","putNode","LEFT","RIGHT","show","speed","isEnemyBullet","direction","event"],"mappings":"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","sourcesContent":["import { _decorator, Collider, Component, ITriggerEvent, Node } from 'cc';\r\nimport { Constant } from '../framework/Constant';\r\nimport { PoolManager } from '../framework/PoolManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\nconst OUTRANGE = -40;\r\nconst ENEMYOUTRANGE = 40;\r\n@ccclass('Bullet')\r\nexport class Bullet extends Component {\r\n    public bulletSpeed = 0;\r\n    private _direction = Constant.Direction.MIDDLE;\r\n    private _isEnemyBullet = false;\r\n\r\n    onEnable () {\r\n        const collider = this.getComponent(Collider);\r\n        collider.on('onTriggerEnter', this._onTriggerEnter, this);\r\n    }\r\n\r\n    onDisable () {\r\n        const collider = this.getComponent(Collider);\r\n        collider.off('onTriggerEnter', this._onTriggerEnter, this);\r\n    }\r\n\r\n    start() {\r\n\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        const pos = this.node.position;\r\n        let moveLength = 0;\r\n        if (this._isEnemyBullet) { // 往 +z 方向\r\n            moveLength = pos.z + this.bulletSpeed;\r\n            this.node.setPosition(pos.x, pos.y, moveLength);\r\n            if (moveLength > ENEMYOUTRANGE) {\r\n                PoolManager.instance().putNode(this.node);\r\n                // this.node.destroy();\r\n                // console.log('enemy bullet destroy');\r\n            }\r\n        } else { // 往 -z 方向\r\n            moveLength = pos.z-this.bulletSpeed;  \r\n            // console.info(\"bullet moveZ\" ,moveLength,OUTRANGE)\r\n            \r\n            // bullet move\r\n            if(this._direction === Constant.Direction.LEFT){\r\n                this.node.setPosition(pos.x - this.bulletSpeed * 0.2, pos.y, moveLength);\r\n            } else if(this._direction === Constant.Direction.RIGHT){\r\n                this.node.setPosition(pos.x + this.bulletSpeed * 0.2, pos.y, moveLength);\r\n            } else{\r\n                this.node.setPosition(pos.x, pos.y, moveLength);\r\n            }\r\n            \r\n            if (moveLength<OUTRANGE){\r\n                PoolManager.instance().putNode(this.node);\r\n                // this.node.destroy();//销毁子弹\r\n                // console.info(\"bullet destroy\" ,moveLength,OUTRANGE)\r\n            }\r\n        }\r\n    }\r\n\r\n    show(speed: number, isEnemyBullet: boolean, direction = Constant.Direction.MIDDLE){\r\n        this.bulletSpeed = speed;\r\n        this._isEnemyBullet = isEnemyBullet;\r\n        this._direction = direction;\r\n        \r\n    }\r\n\r\n    private _onTriggerEnter(event: ITriggerEvent){\r\n        // console.log('trigger  bullet destroy');\r\n        // this.node.destroy();\r\n        PoolManager.instance().putNode(this.node);\r\n    }\r\n\r\n}\r\n\r\n\r\n"]}