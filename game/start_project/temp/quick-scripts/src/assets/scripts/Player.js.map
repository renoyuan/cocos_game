{"version":3,"sources":["assets\\scripts\\Player.js"],"names":["cc","Class","Component","properties","jumpHeight","jumpDuration","maxMoveSpeed","accel","jumpAudio","type","AudioClip","onKeyDown","event","keyCode","macro","KEY","a","accLeft","d","accRight","onKeyUp","runJumpAction","jumpUp","tween","by","y","easing","jumpDown","sequence","call","playJumpSound","repeatForever","audioEngine","playEffect","onLoad","jumpAction","node","then","start","xSpeed","systemEvent","on","SystemEvent","EventType","KEY_DOWN","KEY_UP","onDestroy","off","update","dt","Math","abs","x","console","info"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // 主角跳跃高度\n        jumpHeight: 0,\n        // 主角跳跃持续时间\n        jumpDuration: 0,\n        // 最大移动速度\n        maxMoveSpeed: 0,\n        // 加速度\n        accel: 0,\n\n        // 跳跃音效资源\n        jumpAudio: {\n            default: null,\n            type: cc.AudioClip\n        },\n    },\n\n    onKeyDown (event) {\n        // set a flag when key pressed\n        switch(event.keyCode) {\n            case cc.macro.KEY.a:\n                this.accLeft = true;\n                break;\n            case cc.macro.KEY.d:\n                this.accRight = true;\n                break;\n        }\n    },\n    onKeyUp (event) {\n        // unset a flag when key released\n        switch(event.keyCode) {\n            case cc.macro.KEY.a:\n                this.accLeft = false;\n                break;\n            case cc.macro.KEY.d:\n                this.accRight = false;\n                break;\n        }\n    },\n    runJumpAction () {\n        // 跳跃上升\n        var jumpUp = cc.tween().by(this.jumpDuration, {y: this.jumpHeight}, {easing: 'sineOut'});\n        // 下落\n        var jumpDown = cc.tween().by(this.jumpDuration, {y: -this.jumpHeight}, {easing: 'sineIn'});\n\n        // 创建一个缓动，按 jumpUp、jumpDown 的顺序执行动作\n        var tween = cc.tween()\n         // 按 jumpUp，jumpDown 的顺序执行动作\n        .sequence(jumpUp, jumpDown)\n         // 添加一个回调函数，在前面的动作都结束时调用我们定义的 playJumpSound() 方法\n        .call(this.playJumpSound, this);\n        // 不断重复\n        return cc.tween().repeatForever(tween);\n    },\n    // LIFE-CYCLE CALLBACKS:\n    playJumpSound: function () {\n        // 调用声音引擎播放声音\n        cc.audioEngine.playEffect(this.jumpAudio, false);\n    },\n    // onLoad () {},\n    onLoad: function () {\n       // 初始化跳跃动作\n       var jumpAction = this.runJumpAction();\n       cc.tween(this.node).then(jumpAction).start()\n        // 加速度方向开关\n        this.accLeft = false;\n        this.accRight = false;\n        // 主角当前水平方向速度\n        this.xSpeed = 0;\n        // 初始化键盘输入监听\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);   \n    },\n    onDestroy () {\n        // 取消键盘输入监听\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n    },\n    start () {\n\n    },\n\n    update: function (dt) {\n        // 根据当前加速度方向每帧更新速度\n        if (this.accLeft) {\n            this.xSpeed -= this.accel * dt;\n        }\n        else if (this.accRight) {\n            this.xSpeed += this.accel * dt;\n        };\n\n        // 限制主角的速度不能超过最大值\n        if (Math.abs(this.xSpeed) > this.maxMoveSpeed) {\n            // if speed reach limit, use max speed with current direction\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\n        };\n\n        // 根据当前速度更新主角的位置 &  限制主角位置不能超过边界  this.bg_min = -this.bg.width/2; this.bg_max = this.bg.width/2;\n        \n        if (this.node.x + this.xSpeed * dt <= -480){\n            console.info(\"bg_min update\", -480 );\n            this.node.x = -480;\n        } else if (this.node.x + this.xSpeed * dt >= 480) {\n            console.info(\"bg_max update\", 480);\n            this.node.x = 480;\n        } else{\n            this.node.x += this.xSpeed * dt;\n        }\n            \n\n       \n        \n        \n    },\n});\n"]}